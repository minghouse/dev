<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/css/select2.min.css" rel="stylesheet" />
    <!-- chartjs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.6.0/dist/chart.min.js" crossorigin="anonymous"></script>
    <!-- chartjs-plugin-zoom -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js" crossorigin="anonymous"></script>

    <style>
      .iw-table-draw {
        font-size: 10px;
      }
      .iw-table-draw th, .iw-table-draw td {
        padding: 3px;
      }

      table {
        width: max-content;
        font-size: 105%;
      }
      .table>:not(caption)>*>* {
        padding: .2rem .2rem;
      }

      #dialog_news, #dialog_news2 {
        font-size: 120%;
      }
      .my_index {
        left: 20px !important;
        top: -10px !important;
        z-index: 5;
      }
      .my_index0 {
        z-index: 0 !important;
      }

      .my-badge-sn {
        font-size:70%;
      }
      .my-f-70 {
        font-size:70%;
      }

      .fade-in {
        opacity: 0;
      }

      .fade-in.active {
        opacity: 1;
        transition: opacity 2s ease;
      }

      /* RWD */
      .d-1000 {
        display: none;
      }
      .d-1000-cell {
        display: none;
      }
      .d-1000-inline {
        display: none;
      }
      @media (min-width: 850px) {
        /*td隱藏/顯示*/
        .d-1000 {
          display: block;
        }
        .d-1000-cell {
          display: table-cell;
        }
        .d-1000-inline {
          display: inline;
        }
        .d-1000-none {
          display: none;
        }
      }
    </style>
    <style>
      /* 样式可根据需要进行调整 */
      .select2-container {
        width: 100%;
      }
      .select2 {
        width: 100% !important;
      }
      .select2-container--default .select2-selection--single .select2-selection__arrow {
        height: 38px;
      }
      .select2-container--default .select2-selection--single .select2-selection__rendered {
        line-height: 38px;
      }
      .select2-container .select2-selection--single {
        line-height: 38px;
        height: 38px;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid px-1 d-none" id="container">
      <nav class="navbar mt-1 rounded" style="background-color: #e3f2fd;">
          <div class="container-fluid">
          <span class="navbar-brand fw-bold">自選股 <button type="button" class="btn btn-outline-secondary ms-2" data-bs-toggle="modal" data-bs-target="#buyModal">下單</button></span>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav me-auto mt-2 mb-lg-0">
              <li class="nav-item border-top">
                <a class="nav-link" href="index.html" data-href="?page=1">每日新聞分析</a>
              </li>
              <li class="nav-item border-top">
                <a class="nav-link" href="index6.html" data-href="?page=6">每周新聞分析</a>
              </li>
              <li class="nav-item border-top">
                <a class="nav-link" href="index2.html" data-href="?page=2">每日成交值排行</a>
              </li>
              <li class="nav-item border-top">
                <a class="nav-link" href="index3.html" data-href="?page=3">每日漲幅排行</a>
              </li>
              <li class="nav-item border-top">
                <a class="nav-link active" href="index5.html" data-href="?page=5">自選股</a>
              </li>
              <li class="nav-item border-top">
                <a class="nav-link" href="index7.html" data-href="?page=7">我的關注</a>
              </li>
              <li class="nav-item border-top">
                <a class="nav-link" href="index8.html" data-href="?page=7">區間漲幅排行</a>
              </li>
              <li class="nav-item border-top">
                <a class="nav-link" href="index9.html" data-href="?page=9">週轉率排行</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <div class="mt-2 d-flex">
        <div class=" me-auto">
        </div>
        <div class="d-flex">
          
          <div class="input-group">
            <!-- <div class="btn-group me-2" role="group" aria-label="Basic checkbox toggle button group">
              <input type="checkbox" class="btn-check" id="price1" checked>
              <label class="btn btn-outline-primary position-relative my_index0" for="price1">漲
                <span class="position-absolute top-0 start-100 badge rounded-pill bg-danger my_index" id="price1_badge">
                  0
                </span>
              </label>

              <input type="checkbox" class="btn-check" id="price2">
              <label class="btn btn-outline-primary position-relative my_index0" for="price2">平
                <span class="position-absolute top-0 start-100 badge rounded-pill bg-danger my_index" id="price2_badge">
                  0
                </span>
              </label>

              <input type="checkbox" class="btn-check" id="price3">
              <label class="btn btn-outline-primary position-relative my_index0" for="price3">跌
                <span class="position-absolute top-0 start-100 badge rounded-pill bg-danger my_index" id="price3_badge">
                  0
                </span>
              </label>
            </div> -->
            <div class="input-group">
              <span class="input-group-text">類別:</span>
              <select class="form-select" id="search_text">
                <option value="">ALL</option>
              </select>
            </div>
            
        </div>
        <div class="input-group ms-2" style="height: fit-content;">
          <input type="date" class="form-control rounded-start px-1" placeholder="" id="search_date" >
          <button class="btn btn-outline-secondary" type="button" id="search">查詢</button>
        </div>
          <!-- <button class="btn btn-outline-secondary" type="button" id="search">查詢</button> -->
        </div>
      </div>
      <div class="mt-2 table-responsive border rounded">
        <table class="table">
          <thead>
            <tr>
              <th scope="col" width="10">#</th>
              <th scope="col" style="min-width:80px">商品</th>
              <th scope="col" width="100" class="text-end d-1000-cell">今餘股數</th>
              <th scope="col" width="100" class="text-end d-1000-cell">成交均價</th>
              <th scope="col" width="100" class="text-end ">預估損益</th>
              <th scope="col" width="120" class="text-end d-1000-cell">預估獲利率</th>
              <th scope="col" class="text-center " style="min-width:80px">收盤價
                <!-- <a href="javascript:void(0);" class="text-decoration-none my-f-70" id="show_text_end_price">❔</a></th> -->
              <th scope="col" width="120">新聞
                <a href="javascript:void(0);" class="text-decoration-none" id="show_text_news"><i class="fa-solid fa-circle-question"></i></a>
              </th>
            </tr>
          </thead>
          <tbody id="table_tbody">
            <tr id="table_tr">
              <th scope="row" class="align-middle" rowspan="2">1</th>
              <td class="align-middle">讀取中...</td>
              <td class="align-middle text-end d-1000-cell"></td>
              <td class="align-middle text-end d-1000-cell"></td>
              <td class="align-middle text-end fade-in active"></td>
              <td class="align-middle text-end fade-in active d-1000-cell"></td>
              <td class="align-middle text-center">
                <div class="d-inline position-relative">
                  <span class="fade-in active"></span>
                  <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none" id="continuous_up" style="font-size: 65%;">
                    0
                  </span>
                  <span></span>
                </div>
              </td>
              <td class="align-middle">
                <div class="row g-1">
                  <div class="col">
                    <button type="button" class="btn btn-primary btn-sm position-relative" id="b_news">
                      新聞
                      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                        0
                      </span>
                    </button>
                  </div>
                  <div class="col">
                    <button type="button" class="btn btn-primary btn-sm position-relative" id="b_news_ai">
                      分析
                      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                        0
                      </span>
                    </button>
                  </div>
                </div>
              </td>
            </tr>
            <tr id="table_tr">
              <td colspan="7">
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
    
    <!-- 下單 -->
    <div class="modal fade" id="buyModal" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">下單</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form class="needs-validation" id="buy_form" novalidate>
              <div class="row mb-2">
                <label class="col-2 col-form-label pe-1">分類*</label>
                <div class="col-10">
                  <select class="form-select" id="buy_category" required>
                  </select>
                </div>
              </div>
              <div class="row mb-2">
                <label class="col-2 col-form-label pe-1">商品*</label>
                <div class="col-10">
                  <select class="form-select" id="buy_stock" required>
                  </select>
                </div>
              </div>
              <div class="row mb-2">
                <label class="col-2 col-form-label pe-1">買賣*</label>
                <div class="col-10">
                  <input type="radio" class="btn-check" name="buy_in_out" id="buy_in" autocomplete="off" checked>
                  <label class="btn btn-outline-danger" for="buy_in">買進</label>

                  <input type="radio" class="btn-check" name="buy_in_out" id="buy_out" autocomplete="off">
                  <label class="btn btn-outline-success" for="buy_out">賣出</label>
                </div>
              </div>
              <div class="row mb-2">
                <label class="col-2 col-form-label pe-1">單位*</label>
                <div class="col-10">
                  <div class="input-group ">
                    <input type="number" class="form-control" placeholder="" id="buy_number" value="" list="buy_number_Options" required >
                    <datalist id="buy_number_Options">
                      <option value="10">
                      <option value="20">
                      <option value="50">
                      <option value="100">
                      <option value="200">
                      <option value="300">
                      <option value="500">
                      <option value="1000">
                    </datalist>
                    <span class="input-group-text rounded-end" >股</span>
                    <div class="invalid-feedback">
                      請填寫數字
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2">
                <label class="col-2 col-form-label pe-1">價格*</label>
                <div class="col-10">
                  <div class="input-group ">
                    <input type="number" class="form-control" placeholder="" id="buy_price" step="0.01" required >
                    <button class="btn btn-outline-secondary rounded-end" type="button" id="buy_price_now">即時股價</button>
                    <div class="invalid-feedback">
                      請填寫數字
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mb-2">
                <label class="col-2 col-form-label pe-1">成本</label>
                <div class="col-10 pt-2" id="buy_total">
                  -
                </div>
              </div>
              
              <div class="row mb-2">
                <label class="col-2 col-form-label">備註</label>
                <div class="col-10">
                  <textarea class="form-control" id="buy_note" rows="3"></textarea>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" id="buy_submit">下單</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
          </div>
        </div>
      </div>
    </div>

    <!--新聞-->
    <div class="modal" tabindex="-1" id="dialog_news">
      <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Modal title</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="card w-100 mb-2">
              <div class="card-body">
                <h5 class="card-title fw-bold">Card title</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                <h6 class="card-subtitle mb-2 text-muted d-flex">
                  <div id="news_time">

                  </div>
                  <div class="ms-auto" id="news_link">
                    <a href="#" class="card-link" target="_blank">Card link</a>
                  </div>
                </h6>
              </div>
            </div>
          </div>
          <!-- <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
          </div> -->
        </div>
      </div>
    </div>

    <!--分析-->
    <div class="modal" tabindex="-1" id="dialog_news2">
      <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">分析</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="card w-100 mb-2">
              <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <p class="card-text mb-2"></p>
                <h6 class="card-subtitle text-muted d-flex">
                  <div id="news_time">

                  </div>
                  <div class="ms-auto" id="news_link">
                    
                  </div>
                </h6>
              </div>
            </div>
          </div>
          <!-- <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
          </div> -->
        </div>
      </div>
    </div>

    <!--讀取中-->
    <div class="modal" tabindex="-1" id="dialog_Loading" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-body">
            <div class="d-flex align-items-center">
              <strong>Loading...</strong>
              <div class="spinner-border ms-auto" role="status" aria-hidden="true"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--系統訊息-->
    <div class="modal" tabindex="-1" id="dialog_alert" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">系統訊息</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 預估損益圖表 -->
    <div class="modal" tabindex="-1" id="dialog_chartjs" data-bs-backdrop="static">
      <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">預估損益圖表</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
          </div>
        </div>
      </div>
    </div>

    <script src="	https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/utc.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/timezone.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/js/select2.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <script type="module">
      import sheet_search from 'https://minghouse.github.io/dev/web_server/client/sheet_search.js';
      try {
        // const res = await fetch('https://dev-cpzu.onrender.com/google/sheet_search?range=AI整理-索引!B1:B1')
        // const data = await res.json()
        const data = await sheet_search('AI整理-索引!B1:B1')
        window.scriptURL = `https://script.google.com/macros/s/${data.values[0][0]}/exec`
        // console.log(scriptURL)
      } catch (error) {
        console.error(error)
      }
    </script> -->
    <script type="module">
      import { checkLogin } from "./js/modules/auth.js";
      import getDatas5 from './js/getDatas5.js';
      import getDatas5_buy from './js/getDatas5_buy.js';
      import getDatas5_buy_history from './js/getDatas5_buy_history.js';

      const show_dom = async () => {
        document.querySelector('#container').classList.remove('d-none')
        //股票代號/名稱
        const stock_list = [["0050","元大台灣50"],["0051","元大中型100"],["0052","富邦科技"],["0053","元大電子"],["0055","元大MSCI金融"],["0056","元大高股息"],["0057","富邦摩台"],["0061","元大寶滬深"],["006203","元大MSCI台灣"],["006204","永豐臺灣加權"],["006205","富邦上証"],["006206","元大上證50"],["006207","復華滬深"],["006208","富邦台50"],["00625K","富邦上証+R"],["00631L","元大台灣50正2"],["00632R","元大台灣50反1"],["00633L","富邦上証正2"],["00634R","富邦上証反1"],["00635U","期元大S&P黃金"],["00636","國泰中國A50"],["00636K","國泰中國A50+U"],["00637L","元大滬深300正2"],["00638R","元大滬深300反1"],["00639","富邦深100"],["00640L","富邦日本正2"],["00641R","富邦日本反1"],["00642U","期元大S&P石油"],["00643","群益深証中小"],["00643K","群益深証中小+R"],["00645","富邦日本"],["00646","元大S&P500"],["00647L","元大S&P500正2"],["00648R","元大S&P500反1"],["00650L","復華香港正2"],["00651R","復華香港反1"],["00652","富邦印度"],["00653L","富邦印度正2"],["00654R","富邦印度反1"],["00655L","國泰中國A50正2"],["00656R","國泰中國A50反1"],["00657","國泰日經225"],["00657K","國泰日經225+U"],["00660","元大歐洲50"],["00661","元大日經225"],["00662","富邦NASDAQ"],["00663L","國泰臺灣加權正2"],["00664R","國泰臺灣加權反1"],["00665L","富邦恒生國企正2"],["00666R","富邦恒生國企反1"],["00668","國泰美國道瓊"],["00668K","國泰美國道瓊+U"],["00669R","國泰美國道瓊反1"],["00670L","富邦NASDAQ正2"],["00671R","富邦NASDAQ反1"],["00673R","期元大S&P原油反1"],["00674R","期元大S&P黃金反1"],["00675L","富邦臺灣加權正2"],["00676R","富邦臺灣加權反1"],["00678","群益那斯達克生技"],["00680L","元大美債20正2"],["00681R","元大美債20反1"],["00682U","期元大美元指數"],["00683L","期元大美元指正2"],["00684R","期元大美元指反1"],["00685L","群益臺灣加權正2"],["00686R","群益臺灣加權反1"],["00688L","國泰20年美債正2"],["00689R","國泰20年美債反1"],["00690","兆豐藍籌30"],["00692","富邦公司治理"],["00693U","期街口S&P黃豆"],["00700","富邦恒生國企"],["00701","國泰股利精選30"],["00702","國泰標普低波高息"],["00703","台新MSCI中國"],["00706L","期元大S&P日圓正2"],["00707R","期元大S&P日圓反1"],["00708L","期元大S&P黃金正2"],["00709","富邦歐洲"],["00710B","復華彭博非投等債"],["00711B","復華彭博新興債"],["00712","復華富時不動產"],["00713","元大台灣高息低波"],["00714","群益道瓊美國地產"],["00715L","期街口布蘭特正2"],["00717","富邦美國特別股"],["00728","第一金工業30"],["00730","富邦臺灣優質高息"],["00731","復華富時高息低波"],["00733","富邦臺灣中小"],["00735","國泰臺韓科技"],["00736","國泰新興市場"],["00737","國泰AI+Robo"],["00738U","期元大道瓊白銀"],["00739","元大MSCI A股"],["00752","中信中國50"],["00753L","中信中國50正2"],["00757","統一FANG+"],["00762","元大全球AI"],["00763U","期街口道瓊銅"],["00770","國泰北美科技"],["00771","元大US高息特別股"],["00775B","新光投等債15+"],["00783","富邦中証500"],["00830","國泰費城半導體"],["00850","元大臺灣ESG永續"],["00851","台新全球AI"],["00852L","國泰美國道瓊正2"],["00861","元大全球未來通訊"],["00865B","國泰US短期公債"],["00875","國泰網路資安"],["00876","元大全球5G"],["00878","國泰永續高股息"],["00881","國泰台灣5G+"],["00882","中信中國高股息"],["00885","富邦越南"],["00891","中信關鍵半導體"],["00892","富邦台灣半導體"],["00893","國泰智能電動車"],["00894","中信小資高價30"],["00895","富邦未來車"],["00896","中信綠能及電動車"],["00897","富邦基因免疫生技"],["00898","國泰基因免疫革命"],["00899","FT潔淨能源"],["00900","富邦特選高股息30"],["00901","永豐智能車供應鏈"],["00902","中信電池及儲能"],["00903","富邦元宇宙"],["00904","新光臺灣半導體30"],["00905","FT臺灣Smart"],["00907","永豐優息存股"],["00908","富邦入息REITs+"],["00909","國泰數位支付服務"],["00910","第一金太空衛星"],["00911","兆豐洲際半導體"],["00912","中信臺灣智慧50"],["00913","兆豐台灣晶圓製造"],["00915","凱基優選高股息30"],["00916","國泰全球品牌50"],["00917","中信特選金融"],["00918","大華優利高填息30"],["00919","群益台灣精選高息"],["00920","富邦ESG綠色電力"],["00921","兆豐龍頭等權重"],["00922","國泰台灣領袖50"],["00923","群益台ESG低碳50"],["00924","復華S&P500成長"],["00925","新光標普電動車"],["00926","凱基全球菁英55"],["00927","群益半導體收益"],["00929","復華台灣科技優息"],["00930","永豐ESG低碳高息"],["00932","兆豐永續高息等權"],["00934","中信成長高股息"],["00935","野村臺灣新科技50"],["00936","台新永續高息中小"],["00939","統一台灣高息動能"],["00940","元大台灣價值高息"],["00941","中信上游半導體"],["01001T","土銀富邦R1"],["01002T","土銀國泰R1"],["01004T","土銀富邦R2"],["01007T","兆豐國泰R2"],["01009T","王道圓滿R1"],["01010T","京城樂富R1"],["020000","富邦特選蘋果N"],["020011","統一微波高息20N"],["020012","富邦行動通訊N"],["020015","統一MSCI美低波N"],["020016","統一MSCI美科技N"],["020018","統一價值成長30N"],["020019","統一特選台灣5GN"],["02001L","富邦蘋果正二N"],["02001R","富邦蘋果反一N"],["02001S","策元大加權策略N"],["020020","元大台股領航N"],["020028","元大特選電動車N"],["020029","元大ESG高股息N"],["020030","統一智慧電動車N"],["020031","統一IC設計臺灣N"],["020032","元大綠能N"],["020034","元大IC設計N"],["020036","元大金融配息N"],["020037","元大金融高股息N"],["020038","元大ESG配息N"],["020039","元大加權N"],["1101","台泥"],["1101B","台泥乙特"],["1102","亞泥"],["1103","嘉泥"],["1104","環泥"],["1108","幸福"],["1109","信大"],["1110","東泥"],["1201","味全"],["1203","味王"],["1210","大成"],["1213","大飲"],["1215","卜蜂"],["1216","統一"],["1217","愛之味"],["1218","泰山"],["1219","福壽"],["1220","台榮"],["1225","福懋油"],["1227","佳格"],["1229","聯華"],["1231","聯華食"],["1232","大統益"],["1233","天仁"],["1234","黑松"],["1235","興泰"],["1236","宏亞"],["1256","鮮活果汁-KY"],["1301","台塑"],["1303","南亞"],["1304","台聚"],["1305","華夏"],["1307","三芳"],["1308","亞聚"],["1309","台達化"],["1310","台苯"],["1312","國喬"],["1312A","國喬特"],["1313","聯成"],["1314","中石化"],["1315","達新"],["1316","上曜"],["1319","東陽"],["1321","大洋"],["1323","永裕"],["1324","地球"],["1325","恆大"],["1326","台化"],["1337","再生-KY"],["1338","廣華-KY"],["1339","昭輝"],["1340","勝悅-KY"],["1341","富林-KY"],["1342","八貫"],["1402","遠東新"],["1409","新纖"],["1410","南染"],["1413","宏洲"],["1414","東和"],["1416","廣豐"],["1417","嘉裕"],["1418","東華"],["1419","新紡"],["1423","利華"],["1432","大魯閣"],["1434","福懋"],["1435","中福"],["1436","華友聯"],["1437","勤益控"],["1438","三地開發"],["1439","雋揚"],["1440","南紡"],["1441","大東"],["1442","名軒"],["1443","立益物流"],["1444","力麗"],["1445","大宇"],["1446","宏和"],["1447","力鵬"],["1449","佳和"],["1451","年興"],["1452","宏益"],["1453","大將"],["1454","台富"],["1455","集盛"],["1456","怡華"],["1457","宜進"],["1459","聯發"],["1460","宏遠"],["1463","強盛"],["1464","得力"],["1465","偉全"],["1466","聚隆"],["1467","南緯"],["1468","昶和"],["1470","大統新創"],["1471","首利"],["1472","三洋實業"],["1473","台南"],["1474","弘裕"],["1475","業旺"],["1476","儒鴻"],["1477","聚陽"],["1503","士電"],["1504","東元"],["1506","正道"],["1512","瑞利"],["1513","中興電"],["1514","亞力"],["1515","力山"],["1516","川飛"],["1517","利奇"],["1519","華城"],["1521","大億"],["1522","堤維西"],["1522A","堤維西甲特"],["1524","耿鼎"],["1525","江申"],["1526","日馳"],["1527","鑽全"],["1528","恩德"],["1529","樂事綠能"],["1530","亞崴"],["1531","高林股"],["1532","勤美"],["1533","車王電"],["1535","中宇"],["1536","和大"],["1537","廣隆"],["1538","正峰"],["1539","巨庭"],["1540","喬福"],["1541","錩泰"],["1558","伸興"],["1560","中砂"],["1568","倉佑"],["1582","信錦"],["1583","程泰"],["1587","吉茂"],["1589","永冠-KY"],["1590","亞德客-KY"],["1597","直得"],["1598","岱宇"],["1603","華電"],["1604","聲寶"],["1605","華新"],["1608","華榮"],["1609","大亞"],["1611","中電"],["1612","宏泰"],["1614","三洋電"],["1615","大山"],["1616","億泰"],["1617","榮星"],["1618","合機"],["1626","艾美特-KY"],["1701","中化"],["1702","南僑"],["1707","葡萄王"],["1708","東鹼"],["1709","和益"],["1710","東聯"],["1711","永光"],["1712","興農"],["1713","國化"],["1714","和桐"],["1717","長興"],["1718","中纖"],["1720","生達"],["1721","三晃"],["1722","台肥"],["1723","中碳"],["1725","元禎"],["1726","永記"],["1727","中華化"],["1730","花仙子"],["1731","美吾華"],["1732","毛寶"],["1733","五鼎"],["1734","杏輝"],["1735","日勝化"],["1736","喬山"],["1737","臺鹽"],["1752","南光"],["1760","寶齡富錦"],["1762","中化生"],["1773","勝一"],["1776","展宇"],["1783","和康生"],["1786","科妍"],["1789","神隆"],["1795","美時"],["1802","台玻"],["1805","寶徠"],["1806","冠軍"],["1808","潤隆"],["1809","中釉"],["1810","和成"],["1817","凱撒衛"],["1903","士紙"],["1904","正隆"],["1905","華紙"],["1906","寶隆"],["1907","永豐餘"],["1909","榮成"],["2002","中鋼"],["2002A","中鋼特"],["2006","東和鋼鐵"],["2007","燁興"],["2008","高興昌"],["2009","第一銅"],["2010","春源"],["2012","春雨"],["2013","中鋼構"],["2014","中鴻"],["2015","豐興"],["2017","官田鋼"],["2020","美亞"],["2022","聚亨"],["2023","燁輝"],["2024","志聯"],["2025","千興"],["2027","大成鋼"],["2028","威致"],["2029","盛餘"],["2030","彰源"],["2031","新光鋼"],["2032","新鋼"],["2033","佳大"],["2034","允強"],["2038","海光"],["2049","上銀"],["2059","川湖"],["2062","橋椿"],["2069","運錩"],["2101","南港"],["2102","泰豐"],["2103","台橡"],["2104","國際中橡"],["2105","正新"],["2106","建大"],["2107","厚生"],["2108","南帝"],["2109","華豐"],["2114","鑫永銓"],["2115","六暉-KY"],["2201","裕隆"],["2204","中華"],["2206","三陽工業"],["2207","和泰車"],["2208","台船"],["2211","長榮鋼"],["2227","裕日車"],["2228","劍麟"],["2231","為升"],["2233","宇隆"],["2236","百達-KY"],["2239","英利-KY"],["2241","艾姆勒"],["2243","宏旭-KY"],["2247","汎德永業"],["2250","IKKA-KY"],["2254","巨鎧精密-創"],["2258","鴻華先進-創"],["2301","光寶科"],["2302","麗正"],["2303","聯電"],["2305","全友"],["2308","台達電"],["2312","金寶"],["2313","華通"],["2314","台揚"],["2316","楠梓電"],["2317","鴻海"],["2321","東訊"],["2323","中環"],["2324","仁寶"],["2327","國巨"],["2328","廣宇"],["2329","華泰"],["2330","台積電"],["2331","精英"],["2332","友訊"],["2337","旺宏"],["2338","光罩"],["2340","台亞"],["2342","茂矽"],["2344","華邦電"],["2345","智邦"],["2347","聯強"],["2348","海悅"],["2348A","海悅甲特"],["2349","錸德"],["2351","順德"],["2352","佳世達"],["2353","宏碁"],["2354","鴻準"],["2355","敬鵬"],["2356","英業達"],["2357","華碩"],["2359","所羅門"],["2360","致茂"],["2362","藍天"],["2363","矽統"],["2364","倫飛"],["2365","昆盈"],["2367","燿華"],["2368","金像電"],["2369","菱生"],["2371","大同"],["2373","震旦行"],["2374","佳能"],["2375","凱美"],["2376","技嘉"],["2377","微星"],["2379","瑞昱"],["2380","虹光"],["2382","廣達"],["2383","台光電"],["2385","群光"],["2387","精元"],["2388","威盛"],["2390","云辰"],["2392","正崴"],["2393","億光"],["2395","研華"],["2397","友通"],["2399","映泰"],["2401","凌陽"],["2402","毅嘉"],["2404","漢唐"],["2405","輔信"],["2406","國碩"],["2408","南亞科"],["2409","友達"],["2412","中華電"],["2413","環科"],["2414","精技"],["2415","錩新"],["2417","圓剛"],["2419","仲琦"],["2420","新巨"],["2421","建準"],["2423","固緯"],["2424","隴華"],["2425","承啟"],["2426","鼎元"],["2427","三商電"],["2428","興勤"],["2429","銘旺科"],["2430","燦坤"],["2431","聯昌"],["2432","倚天酷碁-創"],["2433","互盛電"],["2434","統懋"],["2436","偉詮電"],["2438","翔耀"],["2439","美律"],["2440","太空梭"],["2441","超豐"],["2442","新美齊"],["2444","兆勁"],["2449","京元電子"],["2450","神腦"],["2451","創見"],["2453","凌群"],["2454","聯發科"],["2455","全新"],["2457","飛宏"],["2458","義隆"],["2459","敦吉"],["2460","建通"],["2461","光群雷"],["2462","良得電"],["2464","盟立"],["2465","麗臺"],["2466","冠西電"],["2467","志聖"],["2468","華經"],["2471","資通"],["2472","立隆電"],["2474","可成"],["2476","鉅祥"],["2477","美隆電"],["2478","大毅"],["2480","敦陽科"],["2481","強茂"],["2482","連宇"],["2483","百容"],["2484","希華"],["2485","兆赫"],["2486","一詮"],["2488","漢平"],["2489","瑞軒"],["2491","吉祥全"],["2492","華新科"],["2493","揚博"],["2495","普安"],["2496","卓越"],["2497","怡利電"],["2498","宏達電"],["2501","國建"],["2504","國產"],["2505","國揚"],["2506","太設"],["2509","全坤建"],["2511","太子"],["2514","龍邦"],["2515","中工"],["2516","新建"],["2520","冠德"],["2524","京城"],["2527","宏璟"],["2528","皇普"],["2530","華建"],["2534","宏盛"],["2535","達欣工"],["2536","宏普"],["2537","聯上發"],["2538","基泰"],["2539","櫻花建"],["2540","愛山林"],["2542","興富發"],["2543","皇昌"],["2545","皇翔"],["2546","根基"],["2547","日勝生"],["2548","華固"],["2597","潤弘"],["2601","益航"],["2603","長榮"],["2605","新興"],["2606","裕民"],["2607","榮運"],["2608","嘉里大榮"],["2609","陽明"],["2610","華航"],["2611","志信"],["2612","中航"],["2613","中櫃"],["2614","東森"],["2615","萬海"],["2616","山隆"],["2617","台航"],["2618","長榮航"],["2630","亞航"],["2633","台灣高鐵"],["2634","漢翔"],["2636","台驊投控"],["2637","慧洋-KY"],["2642","宅配通"],["2645","長榮航太"],["2701","萬企"],["2702","華園"],["2704","國賓"],["2705","六福"],["2706","第一店"],["2707","晶華"],["2712","遠雄來"],["2722","夏都"],["2723","美食-KY"],["2727","王品"],["2731","雄獅"],["2739","寒舍"],["2748","雲品"],["2753","八方雲集"],["2762","世界健身-KY"],["2801","彰銀"],["2809","京城銀"],["2812","台中銀"],["2816","旺旺保"],["2820","華票"],["2832","台產"],["2834","臺企銀"],["2836","高雄銀"],["2836A","高雄銀甲特"],["2838","聯邦銀"],["2838A","聯邦銀甲特"],["2845","遠東銀"],["2849","安泰銀"],["2850","新產"],["2851","中再保"],["2852","第一保"],["2855","統一證"],["2867","三商壽"],["2880","華南金"],["2881","富邦金"],["2881A","富邦特"],["2881B","富邦金乙特"],["2881C","富邦金丙特"],["2882","國泰金"],["2882A","國泰特"],["2882B","國泰金乙特"],["2883","開發金"],["2883B","開發金乙特"],["2884","玉山金"],["2885","元大金"],["2886","兆豐金"],["2887","台新金"],["2887E","台新戊特"],["2887F","台新戊特二"],["2887Z1","台新己特"],["2888","新光金"],["2888A","新光金甲特"],["2888B","新光金乙特"],["2889","國票金"],["2890","永豐金"],["2891","中信金"],["2891B","中信金乙特"],["2891C","中信金丙特"],["2892","第一金"],["2897","王道銀行"],["2897A","王道銀甲特"],["2901","欣欣"],["2903","遠百"],["2904","匯僑"],["2905","三商"],["2906","高林"],["2908","特力"],["2910","統領"],["2911","麗嬰房"],["2912","統一超"],["2913","農林"],["2915","潤泰全"],["2923","鼎固-KY"],["2929","淘帝-KY"],["2939","凱羿-KY"],["2945","三商家購"],["3002","歐格"],["3003","健和興"],["3004","豐達科"],["3005","神基"],["3006","晶豪科"],["3008","大立光"],["3010","華立"],["3011","今皓"],["3013","晟銘電"],["3014","聯陽"],["3015","全漢"],["3016","嘉晶"],["3017","奇鋐"],["3018","隆銘綠能"],["3019","亞光"],["3021","鴻名"],["3022","威強電"],["3023","信邦"],["3024","憶聲"],["3025","星通"],["3026","禾伸堂"],["3027","盛達"],["3028","增你強"],["3029","零壹"],["3030","德律"],["3031","佰鴻"],["3032","偉訓"],["3033","威健"],["3034","聯詠"],["3035","智原"],["3036","文曄"],["3036A","文曄甲特"],["3037","欣興"],["3038","全台"],["3040","遠見"],["3041","揚智"],["3042","晶技"],["3043","科風"],["3044","健鼎"],["3045","台灣大"],["3046","建碁"],["3047","訊舟"],["3048","益登"],["3049","精金"],["3050","鈺德"],["3051","力特"],["3052","夆典"],["3054","立萬利"],["3055","蔚華科"],["3056","富華新"],["3057","喬鼎"],["3058","立德"],["3059","華晶科"],["3060","銘異"],["3062","建漢"],["3090","日電貿"],["3092","鴻碩"],["3094","聯傑"],["3130","一零四"],["3138","耀登"],["3149","正達"],["3164","景岳"],["3167","大量"],["3168","眾福科"],["3189","景碩"],["3209","全科"],["3229","晟鈦"],["3231","緯創"],["3257","虹冠電"],["3266","昇陽"],["3296","勝德"],["3305","昇貿"],["3308","聯德"],["3311","閎暉"],["3312","弘憶股"],["3321","同泰"],["3338","泰碩"],["3346","麗清"],["3356","奇偶"],["3376","新日興"],["3380","明泰"],["3406","玉晶光"],["3413","京鼎"],["3416","融程電"],["3419","譁裕"],["3432","台端"],["3437","榮創"],["3443","創意"],["3447","展達"],["3450","聯鈞"],["3454","晶睿"],["3481","群創"],["3494","誠研"],["3501","維熹"],["3504","揚明光"],["3515","華擎"],["3518","柏騰"],["3528","安馳"],["3530","晶相光"],["3532","台勝科"],["3533","嘉澤"],["3535","晶彩科"],["3543","州巧"],["3545","敦泰"],["3550","聯穎"],["3557","嘉威"],["3563","牧德"],["3576","聯合再生"],["3583","辛耘"],["3588","通嘉"],["3591","艾笛森"],["3592","瑞鼎"],["3593","力銘"],["3596","智易"],["3605","宏致"],["3607","谷崧"],["3617","碩天"],["3622","洋華"],["3645","達邁"],["3652","精聯"],["3653","健策"],["3661","世芯-KY"],["3665","貿聯-KY"],["3669","圓展"],["3673","TPK-KY"],["3679","新至陞"],["3686","達能"],["3694","海華"],["3701","大眾控"],["3702","大聯大"],["3702A","大聯大甲特"],["3703","欣陸"],["3704","合勤控"],["3705","永信"],["3706","神達"],["3708","上緯投控"],["3711","日月光投控"],["3712","永崴投控"],["3714","富采"],["3715","定穎投控"],["4104","佳醫"],["4106","雃博"],["4108","懷特"],["4119","旭富"],["4133","亞諾法"],["4137","麗豐-KY"],["4142","國光生"],["4148","全宇生技-KY"],["4155","訊映"],["4164","承業醫"],["4190","佐登-KY"],["4306","炎洲"],["4414","如興"],["4426","利勤"],["4438","廣越"],["4439","冠星-KY"],["4440","宜新實業"],["4526","東台"],["4532","瑞智"],["4536","拓凱"],["4540","全球傳動"],["4545","銘鈺"],["4551","智伸科"],["4552","力達-KY"],["4555","氣立"],["4557","永新-KY"],["4560","強信-KY"],["4562","穎漢"],["4564","元翎"],["4566","時碩工業"],["4569","六方科-KY"],["4571","鈞興-KY"],["4572","駐龍"],["4576","大銀微系統"],["4581","光隆精密-KY"],["4583","台灣精銳"],["4588","玖鼎電力"],["4720","德淵"],["4722","國精化"],["4736","泰博"],["4737","華廣"],["4739","康普"],["4746","台耀"],["4755","三福化"],["4763","材料-KY"],["4764","雙鍵"],["4766","南寶"],["4770","上品"],["4771","望隼"],["4807","日成-KY"],["4904","遠傳"],["4906","正文"],["4912","聯德控股-KY"],["4915","致伸"],["4916","事欣科"],["4919","新唐"],["4927","泰鼎-KY"],["4930","燦星網"],["4934","太極"],["4935","茂林-KY"],["4938","和碩"],["4942","嘉彰"],["4943","康控-KY"],["4952","凌通"],["4956","光鋐"],["4958","臻鼎-KY"],["4960","誠美材"],["4961","天鈺"],["4967","十銓"],["4968","立積"],["4976","佳凌"],["4977","眾達-KY"],["4989","榮科"],["4994","傳奇"],["4999","鑫禾"],["5007","三星"],["5203","訊連"],["5215","科嘉-KY"],["5222","全訊"],["5225","東科-KY"],["5234","達興材料"],["5243","乙盛-KY"],["5244","弘凱"],["5258","虹堡"],["5269","祥碩"],["5283","禾聯碩"],["5284","jpp-KY"],["5285","界霖"],["5288","豐祥-KY"],["5292","華懋"],["5306","桂盟"],["5388","中磊"],["5434","崇越"],["5469","瀚宇博"],["5471","松翰"],["5484","慧友"],["5515","建國"],["5519","隆大"],["5521","工信"],["5522","遠雄"],["5525","順天"],["5531","鄉林"],["5533","皇鼎"],["5534","長虹"],["5538","東明-KY"],["5546","永固-KY"],["5607","遠雄港"],["5608","四維航"],["5706","鳳凰"],["5871","中租-KY"],["5871A","中租-KY甲特"],["5876","上海商銀"],["5880","合庫金"],["5906","台南-KY"],["5907","大洋-KY"],["6005","群益證"],["6024","群益期"],["6108","競國"],["6112","邁達特"],["6115","鎰勝"],["6116","彩晶"],["6117","迎廣"],["6120","達運"],["6128","上福"],["6133","金橋"],["6136","富爾特"],["6139","亞翔"],["6141","柏承"],["6142","友勁"],["6152","百一"],["6153","嘉聯益"],["6155","鈞寶"],["6164","華興"],["6165","浪凡"],["6166","凌華"],["6168","宏齊"],["6176","瑞儀"],["6177","達麗"],["6183","關貿"],["6184","大豐電"],["6189","豐藝"],["6191","精成科"],["6192","巨路"],["6196","帆宣"],["6197","佳必琪"],["6201","亞弘電"],["6202","盛群"],["6205","詮欣"],["6206","飛捷"],["6209","今國光"],["6213","聯茂"],["6214","精誠"],["6215","和椿"],["6216","居易"],["6224","聚鼎"],["6225","天瀚"],["6226","光鼎"],["6230","尼得科超眾"],["6235","華孚"],["6239","力成"],["6243","迅杰"],["6257","矽格"],["6269","台郡"],["6271","同欣電"],["6277","宏正"],["6278","台表科"],["6281","全國電"],["6282","康舒"],["6283","淳安"],["6285","啟碁"],["6288","聯嘉"],["6405","悅城"],["6409","旭隼"],["6412","群電"],["6414","樺漢"],["6415","矽力*-KY"],["6416","瑞祺電通"],["6426","統新"],["6431","光麗-KY"],["6438","迅得"],["6442","光聖"],["6443","元晶"],["6446","藥華藥"],["6449","鈺邦"],["6451","訊芯-KY"],["6456","GIS-KY"],["6464","台數科"],["6472","保瑞"],["6477","安集"],["6491","晶碩"],["6504","南六"],["6505","台塑化"],["6515","穎崴"],["6525","捷敏-KY"],["6526","達發"],["6531","愛普*"],["6533","晶心科"],["6534","正瀚-創"],["6541","泰福-KY"],["6550","北極星藥業-KY"],["6552","易華電"],["6558","興能高"],["6573","虹揚-KY"],["6579","研揚"],["6581","鋼聯"],["6582","申豐"],["6585","鼎基"],["6591","動力-KY"],["6592","和潤企業"],["6592A","和潤企業甲特"],["6592B","和潤企業乙特"],["6598","ABC-KY"],["6605","帝寶"],["6606","建德工業"],["6625","必應"],["6641","基士德-KY"],["6645","金萬林-創"],["6655","科定"],["6657","華安"],["6658","聯策"],["6666","羅麗芬-KY"],["6668","中揚光"],["6669","緯穎"],["6670","復盛應用"],["6671","三能-KY"],["6672","騰輝電子-KY"],["6674","鋐寶科技"],["6689","伊雲谷"],["6691","洋基工程"],["6695","芯鼎"],["6698","旭暉應材"],["6706","惠特"],["6715","嘉基"],["6719","力智"],["6742","澤米"],["6743","安普新"],["6753","龍德造船"],["6754","匯僑設計"],["6756","威鋒電子"],["6757","台灣虎航-創"],["6768","志強-KY"],["6770","力積電"],["6776","展碁國際"],["6781","AES-KY"],["6782","視陽"],["6789","采鈺"],["6790","永豐實"],["6792","詠業"],["6796","晉弘"],["6799","來頡"],["6805","富世達"],["6806","森崴能源"],["6807","峰源-KY"],["6830","汎銓"],["6834","天二科技"],["6835","圓裕"],["6854","錼創科技-KY創"],["6861","睿生光電"],["6863","永道-KY"],["6869","雲豹能源-創"],["6873","泓德能源-創"],["6901","鑽石投資"],["6902","走著瞧-創"],["6906","現觀科"],["6916","華凌"],["6933","AMAX-KY"],["6937","天虹"],["6949","沛爾生醫-創"],["8011","台通"],["8016","矽創"],["8021","尖點"],["8028","昇陽半導體"],["8033","雷虎"],["8039","台虹"],["8046","南電"],["8070","長華*"],["8072","陞泰"],["8081","致新"],["8101","華冠"],["8103","瀚荃"],["8104","錸寶"],["8105","凌巨"],["8110","華東"],["8112","至上"],["8112A","至上甲特"],["8114","振樺電"],["8131","福懋科"],["8150","南茂"],["8162","微矽電子-創"],["8163","達方"],["8201","無敵"],["8210","勤誠"],["8213","志超"],["8215","明基材"],["8222","寶一"],["8249","菱光"],["8261","富鼎"],["8271","宇瞻"],["8341","日友"],["8367","建新國際"],["8374","羅昇"],["8404","百和興業-KY"],["8411","福貞-KY"],["8422","可寧衛"],["8429","金麗-KY"],["8438","昶昕"],["8442","威宏-KY"],["8443","阿瘦"],["8454","富邦媒"],["8462","柏文"],["8463","潤泰材"],["8464","億豐"],["8466","美吉吉-KY"],["8467","波力-KY"],["8473","山林水"],["8476","台境"],["8478","東哥遊艇"],["8481","政伸"],["8482","商億-KY"],["8487","愛爾達-創"],["8488","吉源-KY"],["8499","鼎炫-KY"],["8926","台汽電"],["8940","新天地"],["8996","高力"],["9103","美德醫療-DR"],["910322","康師傅-DR"],["9105","泰金寶-DR"],["910861","神州-DR"],["9110","越南控-DR"],["911608","明輝-DR"],["911622","泰聚亨-DR"],["911868","同方友友-DR"],["912000","晨訊科-DR"],["9136","巨騰-DR"],["9802","鈺齊-KY"],["9902","台火"],["9904","寶成"],["9905","大華"],["9906","欣巴巴"],["9907","統一實"],["9908","大台北"],["9910","豐泰"],["9911","櫻花"],["9912","偉聯"],["9914","美利達"],["9917","中保科"],["9918","欣天然"],["9919","康那香"],["9921","巨大"],["9924","福興"],["9925","新保"],["9926","新海"],["9927","泰銘"],["9928","中視"],["9929","秋雨"],["9930","中聯資源"],["9931","欣高"],["9933","中鼎"],["9934","成霖"],["9935","慶豐富"],["9937","全國"],["9938","百和"],["9939","宏全"],["9940","信義"],["9941","裕融"],["9941A","裕融甲特"],["9942","茂順"],["9943","好樂迪"],["9944","新麗"],["9945","潤泰新"],["9946","三發地產"],["9955","佳龍"],["9958","世紀鋼"],["00679B","元大美債20年"],["00687B","國泰20年美債"],["00694B","富邦美債1-3"],["00695B","富邦美債7-10"],["00696B","富邦美債20年"],["00697B","元大美債7-10"],["00718B","富邦中國政策債"],["00719B","元大美債1-3"],["00720B","元大投資級公司債"],["00721B","元大中國債3-5"],["00722B","群益投資級電信債"],["00723B","群益投資級科技債"],["00724B","群益投資級金融債"],["00725B","國泰投資級公司債"],["00726B","國泰5Y+新興債"],["00727B","國泰1-5Y非投等債"],["00734B","台新JPM新興債"],["00740B","富邦全球投等債"],["00741B","富邦全球非投等債"],["00746B","富邦A級公司債"],["00749B","凱基新興債10+"],["00750B","凱基科技債10+"],["00751B","元大AAA至A公司債"],["00754B","群益AAA-AA公司債"],["00755B","群益投資級公用債"],["00756B","群益投等新興公債"],["00758B","復華能源債"],["00759B","復華製藥債"],["00760B","復華新興企業債"],["00761B","國泰A級公司債"],["00764B","群益25年美債"],["00768B","復華20年美債"],["00772B","中信高評級公司債"],["00773B","中信優先金融債"],["00777B","凱基AAA至A公司債"],["00778B","凱基金融債20+"],["00779B","凱基美債25+"],["00780B","國泰A級金融債"],["00781B","國泰A級科技債"],["00782B","國泰A級公用債"],["00784B","富邦中國投等債"],["00785B","富邦金融投等債"],["00786B","元大10年IG銀行債"],["00787B","元大10年IG醫療債"],["00788B","元大10年IG電能債"],["00789B","復華公司債A3"],["00790B","復華次順位金融債"],["00791B","復華信用債1-5"],["00792B","群益A級公司債"],["00793B","群益AAA-A醫療債"],["00794B","群益7+中國政金債"],["00795B","中信美國公債20年"],["00799B","國泰A級醫療債"],["00831B","新光美債1-3"],["00834B","第一金金融債10+"],["00836B","永豐10年A公司債"],["00840B","凱基IG精選15+"],["00841B","凱基AAA-AA公司債"],["00842B","台新美元銀行債"],["00844B","新光15年IG金融債"],["00845B","富邦新興投等債"],["00846B","富邦歐洲銀行債"],["00847B","中信美國市政債"],["00848B","中信新興亞洲債"],["00849B","中信EM主權債0-5"],["00853B","統一美債10年Aa-A"],["00856B","永豐1-3年美公債"],["00857B","永豐20年美公債"],["00858","永豐美國500大"],["00859B","群益0-1年美債"],["00860B","群益1-5Y投資級債"],["00862B","中信投資級公司債"],["00863B","中信全球電信債"],["00864B","中信美國公債0-1"],["00867B","新光A-BBB電信債"],["00870B","元大15年EM主權債"],["00877","復華中國5G"],["00883B","中信ESG投資級債"],["00884B","中信低碳新興債"],["00886","永豐美國科技"],["00887","永豐中國科技50大"],["00888","永豐台灣ESG"],["00890B","凱基ESG BBB債15+"],["00928","中信上櫃ESG 30"],["00931B","統一美債20年"],["00933B","國泰10Y+金融債"],["00937B","群益ESG投等債20+"],["00942B","台新美A公司債20+"],["1240","茂生農經"],["1259","安心"],["1264","德麥"],["1268","漢來美食"],["1336","台翰"],["1565","精華"],["1569","濱川"],["1570","力肯"],["1580","新麥"],["1584","精剛"],["1586","和勤"],["1591","駿吉-KY"],["1593","祺驊"],["1595","川寶"],["1599","宏佳騰"],["1742","台蠟"],["1777","生泰"],["1781","合世"],["1784","訊聯"],["1785","光洋科"],["1788","杏昌"],["1796","金穎生技"],["1799","易威"],["1813","寶利徠"],["1815","富喬"],["02001B","統一美國政府債N"],["2035","唐榮"],["2061","風青"],["2063","世鎧"],["2064","晉椿"],["2065","世豐"],["2066","世德"],["2067","嘉鋼"],["2070","精湛"],["2073","雄順"],["2221","大甲"],["2230","泰茂"],["2235","謚源"],["2596","綠意"],["2640","大車隊"],["2641","正德"],["2643","捷迅"],["2718","晶悅"],["2719","燦星旅"],["2724","藝舍-KY"],["2726","雅茗-KY"],["2729","瓦城"],["2732","六角"],["2734","易飛網"],["2736","富野"],["2740","天蔥"],["2743","山富"],["2745","五福"],["2752","豆府"],["2754","亞洲藏壽司"],["2755","揚秦"],["2756","聯發國際"],["2916","滿心"],["2924","宏太-KY"],["2926","誠品生活"],["2937","集雅社"],["2941","米斯特"],["2947","振宇五金"],["2948","寶陞"],["2949","欣新網"],["3064","泰偉"],["3066","李洲"],["3067","全域"],["3071","協禧"],["3073","天方能源"],["3078","僑威"],["3081","聯亞"],["3083","網龍"],["3085","新零售"],["3086","華義"],["3088","艾訊"],["3093","港建*"],["3095","及成"],["3105","穩懋"],["3114","好德"],["3115","富榮綱"],["3118","進階"],["3122","笙泉"],["3128","昇銳"],["3131","弘塑"],["3141","晶宏"],["3147","大綜"],["3152","璟德"],["3162","精確"],["3163","波若威"],["3169","亞信"],["3171","新洲"],["3176","基亞"],["3178","公準"],["3188","鑫龍騰"],["3191","雲科"],["3202","樺晟"],["3205","佰研"],["3206","志豐"],["3207","耀勝"],["3211","順達"],["3213","茂訊"],["3217","優群"],["3218","大學光"],["3219","倚強科"],["3221","台嘉碩"],["3224","三顧"],["3226","至寶電"],["3227","原相"],["3228","金麗科"],["3230","錦明"],["3232","昱捷"],["3234","光環"],["3236","千如"],["3252","海灣"],["3259","鑫創"],["3260","威剛"],["3264","欣銓"],["3265","台星科"],["3268","海德威"],["3272","東碩"],["3276","宇環"],["3284","太普高"],["3285","微端"],["3287","廣寰科"],["3288","點晶"],["3289","宜特"],["3290","東浦"],["3293","鈊象"],["3294","英濟"],["3297","杭特"],["3303","岱稜"],["3306","鼎天"],["3310","佳穎"],["3313","斐成"],["3317","尼克森"],["3322","建舜電"],["3323","加百裕"],["3324","雙鴻"],["3325","旭品"],["3332","幸康"],["3339","泰谷"],["3349","寶德"],["3354","律勝"],["3357","臺慶科"],["3360","尚立"],["3362","先進光"],["3363","上詮"],["3372","典範"],["3373","熱映"],["3374","精材"],["3379","彬台"],["3388","崇越電"],["3390","旭軟"],["3402","漢科"],["3426","台興"],["3430","奇鈦科"],["3434","哲固"],["3438","類比科"],["3441","聯一光"],["3444","利機"],["3455","由田"],["3465","進泰電子"],["3466","德晉"],["3479","安勤"],["3483","力致"],["3484","崧騰"],["3489","森寶"],["3490","單井"],["3491","昇達科"],["3492","長盛"],["3498","陽程"],["3499","環天科"],["3508","位速"],["3511","矽瑪"],["3512","皇龍"],["3516","亞帝歐"],["3520","華盈"],["3521","鴻翊"],["3522","御頂"],["3523","迎輝"],["3526","凡甲"],["3527","聚積"],["3529","力旺"],["3531","先益"],["3537","堡達"],["3540","曜越"],["3541","西柏"],["3546","宇峻"],["3548","兆利"],["3551","世禾"],["3552","同致"],["3555","博士旺"],["3556","禾瑞亞"],["3558","神準"],["3564","其陽"],["3567","逸昌"],["3570","大塚"],["3577","泓格"],["3580","友威科"],["3581","博磊"],["3587","閎康"],["3594","磐儀"],["3597","映興"],["3609","三一東林"],["3611","鼎翰"],["3615","安可"],["3623","富晶通"],["3624","光頡"],["3625","西勝"],["3628","盈正"],["3629","地心引力"],["3630","新鉅科"],["3631","晟楠"],["3632","研勤"],["3646","艾恩特"],["3663","鑫科"],["3664","安瑞-KY"],["3666","光耀"],["3672","康聯訊"],["3675","德微"],["3680","家登"],["3684","榮昌"],["3685","元創精密"],["3687","歐買尬"],["3689","湧德"],["3691","碩禾"],["3693","營邦"],["3707","漢磊"],["3709","鑫聯大投控"],["3710","連展投控"],["3713","新晶投控"],["4102","永日"],["4105","東洋"],["4107","邦特"],["4109","加捷生醫"],["4111","濟生"],["4113","聯上"],["4114","健喬"],["4116","明基醫"],["4120","友華"],["4121","優盛"],["4123","晟德"],["4126","太醫"],["4127","天良"],["4128","中天"],["4129","聯合"],["4130","健亞"],["4131","浩泰"],["4138","曜亞"],["4139","馬光-KY"],["4147","中裕"],["4153","鈺緯"],["4154","樂威科-KY"],["4157","太景*-KY"],["4160","訊聯基因"],["4161","聿新科"],["4162","智擎"],["4163","鐿鈦"],["4167","松瑞藥"],["4168","醣聯"],["4171","瑞基"],["4173","久裕"],["4174","浩鼎"],["4175","杏一"],["4183","福永生技"],["4188","安克"],["4192","杏國"],["4198","欣大健康"],["4205","中華食"],["4207","環泰"],["4303","信立"],["4304","勝昱"],["4305","世坤"],["4401","東隆興"],["4402","福大"],["4406","新昕纖"],["4413","飛寶企業"],["4416","三圓"],["4417","金洲"],["4419","元勝"],["4420","光明"],["4430","耀億"],["4432","銘旺實"],["4433","興采"],["4442","竣邦-KY"],["4502","健信"],["4503","金雨"],["4506","崇友"],["4510","高鋒"],["4513","福裕"],["4523","永彰"],["4527","方土霖"],["4528","江興鍛"],["4529","淳紳"],["4530","宏易"],["4533","協易機"],["4534","慶騰"],["4535","至興"],["4538","大詠城"],["4541","晟田"],["4542","科嶠"],["4543","萬在"],["4549","桓達"],["4550","長佳"],["4554","橙的"],["4556","旭然"],["4558","寶緯"],["4561","健椿"],["4563","百德"],["4568","科際精密"],["4577","達航科技"],["4580","捷流閥業"],["4584","君帆"],["4609","唐鋒"],["4702","中美實"],["4706","大恭"],["4707","磐亞"],["4711","永純"],["4714","永捷"],["4716","大立"],["4721","美琪瑪"],["4726","永昕"],["4728","雙美"],["4729","熒茂"],["4735","豪展"],["4741","泓瀚"],["4743","合一"],["4744","皇將"],["4745","合富-KY"],["4747","強生"],["4754","國碳科"],["4760","勤凱"],["4767","誠泰科技"],["4768","晶呈科技"],["4804","大略-KY"],["4806","昇華"],["4903","聯光通"],["4905","台聯電"],["4907","富宇"],["4908","前鼎"],["4909","新復興"],["4911","德英"],["4923","力士"],["4924","欣厚-KY"],["4931","新盛力"],["4933","友輝"],["4939","亞電"],["4945","陞達科技"],["4946","辣椒"],["4951","精拓科"],["4953","緯軟"],["4966","譜瑞-KY"],["4971","IET-KY"],["4972","湯石照明"],["4973","廣穎"],["4974","亞泰"],["4979","華星光"],["4987","科誠"],["4991","環宇-KY"],["4995","晶達"],["5009","榮剛"],["5011","久陽"],["5013","強新"],["5014","建錩"],["5015","華祺"],["5016","松和"],["5201","凱衛"],["5202","力新"],["5205","中茂"],["5206","坤悅"],["5209","新鼎"],["5210","寶碩"],["5211","蒙恬"],["5212","凌網"],["5213","亞昕"],["5220","萬達光電"],["5223","安力-KY"],["5227","立凱-KY"],["5228","鈺鎧"],["5230","雷笛克光學"],["5236","凌陽創新"],["5245","智晶"],["5251","天鉞電"],["5263","智崴"],["5272","笙科"],["5274","信驊"],["5276","達輝-KY"],["5278","尚凡"],["5287","數字"],["5289","宜鼎"],["5291","邑昇"],["5299","杰力"],["5301","寶得利"],["5302","太欣"],["5309","系統電"],["5310","天剛"],["5312","寶島科"],["5314","世紀"],["5315","光聯"],["5321","美而快"],["5324","士開"],["5328","華容"],["5340","建榮"],["5344","立衛"],["5345","天揚"],["5347","世界"],["5348","正能量智能"],["5351","鈺創"],["5353","台林"],["5355","佳總"],["5356","協益"],["5364","力麗店"],["5371","中光電"],["5381","合正"],["5383","金利"],["5386","青雲"],["5392","能率"],["5398","慕康生醫"],["5403","中菲"],["5410","國眾"],["5425","台半"],["5426","振發"],["5432","新門"],["5438","東友"],["5439","高技"],["5443","均豪"],["5450","南良"],["5452","佶優"],["5455","昇益"],["5457","宣德"],["5460","同協"],["5464","霖宏"],["5465","富驊"],["5468","凱鈺"],["5474","聰泰"],["5475","德宏"],["5478","智冠"],["5481","新華"],["5483","中美晶"],["5487","通泰"],["5488","松普"],["5489","彩富"],["5490","同亨"],["5493","三聯"],["5498","凱崴"],["5508","永信建"],["5511","德昌"],["5512","力麒"],["5514","三豐"],["5516","雙喜"],["5520","力泰"],["5523","豐謙"],["5529","鉅陞"],["5530","龍巖"],["5536","聖暉*"],["5543","桓鼎-KY"],["5548","安倉"],["5601","台聯櫃"],["5603","陸海"],["5604","中連"],["5609","中菲行"],["5701","劍湖山"],["5703","亞都"],["5704","老爺知"],["5864","致和證"],["5878","台名"],["5902","德記"],["5903","全家"],["5904","寶雅"],["5905","南仁湖"],["6015","宏遠證"],["6016","康和證"],["6020","大展證"],["6021","美好證"],["6023","元大期"],["6026","福邦證"],["6101","寬魚國際"],["6103","合邦"],["6104","創惟"],["6109","亞元"],["6111","大宇資"],["6113","亞矽"],["6114","久威"],["6118","建達"],["6121","新普"],["6122","擎邦"],["6123","上奇"],["6124","業強"],["6125","廣運"],["6126","信音"],["6127","九豪"],["6129","普誠"],["6130","上亞科技"],["6134","萬旭"],["6138","茂達"],["6140","訊達"],["6143","振曜"],["6144","得利影"],["6146","耕興"],["6147","頎邦"],["6148","驊宏資"],["6150","撼訊"],["6151","晉倫"],["6154","順發"],["6156","松上"],["6158","禾昌"],["6160","欣技"],["6161","捷波"],["6163","華電網"],["6167","久正"],["6169","昱泉"],["6170","統振"],["6171","大城地產"],["6173","信昌電"],["6174","安碁"],["6175","立敦"],["6179","亞通"],["6180","橘子"],["6182","合晶"],["6185","幃翔"],["6186","新潤"],["6187","萬潤"],["6188","廣明"],["6190","萬泰科"],["6194","育富"],["6195","詩肯"],["6198","瑞築"],["6199","天品"],["006201","元大富櫃50"],["6203","海韻電"],["6204","艾華"],["6207","雷科"],["6208","日揚"],["6210","慶生"],["6212","理銘"],["6217","中探針"],["6218","豪勉"],["6219","富旺"],["6220","岳豐"],["6221","晉泰"],["6222","上揚"],["6223","旺矽"],["6227","茂綸"],["6228","全譜"],["6229","研通"],["6231","系微"],["6233","旺玖"],["6234","高僑"],["6236","中湛"],["6237","驊訊"],["6240","松崗"],["6241","易通展"],["6242","立康"],["6244","茂迪"],["6245","立端"],["6246","臺龍"],["6248","沛波"],["6259","百徽"],["6261","久元"],["6263","普萊德"],["6264","富裔"],["6265","方土昶"],["6266","泰詠"],["6270","倍微"],["6274","台燿"],["6275","元山"],["6276","安鈦克"],["6279","胡連"],["6284","佳邦"],["6287","元隆"],["6290","良維"],["6291","沛亨"],["6292","迅德"],["6294","智基"],["6411","晶焱"],["6417","韋僑"],["6418","詠昇"],["6419","京晨科"],["6425","易發"],["6432","今展科"],["6435","大中"],["6441","廣錠"],["6457","紘康"],["6461","益得"],["6462","神盾"],["6465","威潤"],["6469","大樹"],["6470","宇智"],["6482","弘煜科"],["6485","點序"],["6486","互動"],["6488","環球晶"],["6492","生華科"],["6494","九齊"],["6496","科懋"],["6499","益安"],["6506","雙邦"],["6508","惠光"],["6509","聚和"],["6510","精測"],["6512","啟發電"],["6514","芮特-KY"],["6516","勤崴國際"],["6517","保勝光學"],["6523","達爾膚"],["6527","明達醫"],["6530","創威"],["6532","瑞耘"],["6535","順藥"],["6538","倉和"],["6542","隆中"],["6546","正基"],["6547","高端疫苗"],["6548","長科*"],["6556","勝品"],["6560","欣普羅"],["6561","是方"],["6568","宏觀"],["6569","醫揚"],["6570","維田"],["6574","霈方"],["6576","逸達"],["6577","勁豐"],["6578","達邦蛋白"],["6584","南俊國際"],["6588","東典光電"],["6589","台康生技"],["6590","普鴻"],["6593","台灣銘板"],["6596","寬宏藝術"],["6603","富強鑫"],["6609","瀧澤科"],["6612","奈米醫材"],["6613","朋億*"],["6615","慧智"],["6616","特昇-KY"],["6624","萬年清"],["6629","泰金-KY"],["6640","均華"],["6642","富致"],["6643","M31"],["6649","台生材"],["6651","全宇昕"],["6654","天正國際"],["6661","威健生技"],["6662","樂斯科"],["6664","群翊"],["6667","信紘科"],["6679","鈺太"],["6680","鑫創電子"],["6683","雍智科技"],["6684","安格"],["6690","安碁資訊"],["6692","進能服"],["6693","廣閎科"],["6697","東捷資訊"],["6703","軒郁"],["6708","天擎"],["6712","長聖"],["6716","應廣"],["6721","信實"],["6727","亞泰金屬"],["6728","上洋"],["6732","昇佳電子"],["6733","博晟生醫"],["6735","美達科技"],["6741","91APP*-KY"],["6747","亨泰光"],["6751","智聯服務"],["6752","叡揚"],["6761","穩得"],["6762","達亞"],["6763","綠界科技"],["6767","台微醫"],["6785","昱展新藥"],["6788","華景電"],["6791","虎門科技"],["6803","崑鼎"],["6804","明係"],["6811","宏碁資訊"],["6821","聯寶"],["6823","濾能"],["6829","千附精密"],["6840","東研信超"],["6841","長佳智能"],["6843","進典"],["6844","諾貝兒"],["6846","綠茵"],["6855","數泓科"],["6856","鑫傳"],["6859","伯特光"],["6865","偉康科技"],["6870","騰雲"],["6874","倍力"],["6875","國邑*"],["6877","鏵友益"],["6894","衛司特"],["6895","宏碩系統"],["6899","創為精密"],["6904","伯鑫"],["6922","宸曜"],["6929","佑全"],["7402","邑錡"],["7556","意德士"],["8024","佑華"],["8027","鈦昇"],["8032","光菱"],["8034","榮群"],["8038","長園科"],["8040","九暘"],["8042","金山電"],["8043","蜜望實"],["8044","網家"],["8047","星雲"],["8048","德勝"],["8049","晶采"],["8050","廣積"],["8054","安國"],["8059","凱碩"],["8064","東捷"],["8066","來思達"],["8067","志旭"],["8068","全達"],["8069","元太"],["8071","能率網通"],["8074","鉅橡"],["8076","伍豐"],["8077","洛碁"],["8080","印鉐"],["8083","瑞穎"],["8084","巨虹"],["8085","福華"],["8086","宏捷科"],["8087","華鎂鑫"],["8088","品安"],["8089","康全電訊"],["8091","翔名"],["8092","建暐"],["8093","保銳"],["8096","擎亞"],["8097","常珵"],["8099","大世科"],["8107","大億金茂"],["8109","博大"],["8111","立碁"],["8121","越峰"],["8147","正淩"],["8155","博智"],["8171","天宇"],["8176","智捷"],["8182","加高"],["8183","精星"],["8227","巨有科技"],["8234","新漢"],["8240","華宏"],["8255","朋程"],["8277","商丞"],["8279","生展"],["8284","三竹"],["8289","泰藝"],["8291","尚茂"],["8299","群聯"],["8342","益張"],["8349","恒耀"],["8349A","恒耀甲特"],["8354","冠好"],["8358","金居"],["8383","千附"],["8390","金益鼎"],["8401","白紗科"],["8403","盛弘"],["8409","商之器"],["8410","森田"],["8415","大國鋼"],["8416","實威"],["8420","明揚"],["8421","旭源"],["8423","保綠-KY"],["8424","惠普"],["8426","紅木-KY"],["8431","匯鑽科"],["8432","東生華"],["8433","弘帆"],["8435","鉅邁"],["8436","大江"],["8437","大地-KY"],["8440","綠電"],["8444","綠河-KY"],["8446","華研"],["8450","霹靂"],["8455","大拓-KY"],["8472","夠麻吉"],["8477","創業家"],["8489","三貝德"],["8905","裕國"],["8906","花王"],["8908","欣雄"],["8916","光隆"],["8917","欣泰"],["8921","沈氏"],["8923","時報"],["8924","大田"],["8927","北基"],["8928","鉅明"],["8929","富堡"],["8930","青鋼"],["8931","大汽電"],["8932","智通"],["8933","愛地雅"],["8935","邦泰"],["8936","國統"],["8937","合騏"],["8938","明安"],["8941","關中"],["8942","森鉅"],["9949","琉園"],["9950","萬國通"],["9951","皇田"],["9960","邁達康"],["9962","有益"],["020001","富邦存股雙十N"],["020023","元大櫃買半導體N"],["020025","統一亞洲半導體N"],["020026","兆豐上櫃ESG電菁N"],["020027","元大上櫃ESG成長N"],["020033","統一恒生科期N"],["020035","元大上櫃ESG高息N"],["020040","元大上櫃ESG龍頭N"],["020041","兆豐半導體氣候N"]]

        /////////////////////////////////
        //取得股票即時資料
        const fugle_key = [
          'OGFkOTY4NzEtNzgyZi00YzU1LWJhN2YtYTc4MDc5M2EyMWU5IDg4ZmYyZTE3LTRhY2EtNDZkYi05ODdhLWVmZjA3ZDNjZjZiZg==',
          'MDQzZWY3OWQtMjFjMC00NmE4LWI0YzQtNzBiYzZhMjYwMjI0IDhiNTcyNzQ5LTI1MGMtNDYyMy05NzVmLWU5OWY2YmIwMzA3Ng==',
          'MjE3ODRjZDYtYTM5YS00OGNhLTk4ZDItZWYzYTAxZGMzYzU0IGE0N2Q2ZGVkLTEwYWQtNGMxNS04MGNmLWZjODE5OGVlOWVkZA==',
          'YmMwNTg2MWEtZDQ3Yi00OTAwLWJkYTEtZmEzYjc4ZmIxMjE4IDY3ZjMyYTdjLTFjZmUtNDBkYy1iZTYwLWExOGFkYjJmZDUxMw==',
          'ZmExNmFkNmYtNDRiYi00MDdkLWJlNTMtYmJkMTRhNzUyY2YxIGQ0NzQzYjM4LWM0MjItNDdjMi1iOGU4LTdkOTJiY2NmZDI0Yg==',

          'M2JjNzc1NTYtZTc5Ni00MTkxLTljMTItZTU5NTM3Mzc1NjViIDA5MWQ1NGMyLTRkZmItNDUxZi05NDJhLTcyMDA1MjUyNGZiYw==',
          'NDlmZjk1ZDgtNzM3Mi00MmRlLTlkMWItNDY0OTY5ZTA4NTIyIDg3ZmFlMjBjLTQzYzctNGNlZC04ZWRmLWI4OTU0MDM4ZWI4ZQ==',
          'YjA4ODNiYTQtYzhjYy00NjNlLWFjZTAtY2Q0NTBlNmRmZDgxIGJlZTI1YmQ4LTA5OTAtNDM1Ny04MzA5LTY1OTEyODAzNGQwZQ==',
          'N2M3ZTFkMjktZGE2NS00ZDUwLWIwZmUtMzdjMjdkOWNiZGJkIGRjNDYxMDkzLTY0ZjgtNDNmMC05ZmE5LWE1MWRkYWJkNjEzYQ==',
          'OTVkZjU1N2UtNGZhYi00NzA2LWE3ZTEtMTdlYzlhYTVhNmNhIDBiMWVmMzJlLTE3ZjgtNDZmYy1iMmQyLTczNjQyMzc4ODVhMw==',

          'ZDQ1OGJiNTctZDAyMC00ZTVlLWJkNzEtOWRlMWU0MmJkZWY0IDUzY2MyYTE1LTRmNzYtNDY4YS1iNGE4LTRlMGJhODZjM2UzYQ==',
          'YjNiMjhiNTItYjE2ZS00OTg0LWI0NTUtYzQ3OWUxMGIxOTA2IGJlMmNmZjlmLWYxNjctNGJjMS05MTI0LTAxNTkyZjRlMWFhYw==',
          'NjgyNDE2ZWMtNzU5MC00NGU4LWEwNmMtMjhkNzM3NWQ2ODQzIDYxNjg3NzViLWUwY2EtNGQ4Yy1hMzIzLTc4MTg1MDdiN2VlNA==',
          'Y2RhYTU0YTktNjI2Yi00NWYyLTkxZGYtNjFmMWFmNWRjNGYwIDk5Mzg0YjZhLTdkZWQtNDdmNC05YjdkLTA3ODBkODllOWU4Nw==',

        ]
        const get_stock = async (i, stock) => {
          const result = await fetch(`https://api.fugle.tw/marketdata/v1.0/stock/intraday/quote/${stock}`, {
            headers: {
              'X-API-KEY': fugle_key[i%14]
            }
          })
          const data = await result.json()
          return data
        }
        /////////////////////////////////

        //Menu控制
        const dom_dialog_Loading = new bootstrap.Modal('#dialog_Loading', {
          keyboard: false
        })
        // function loadNewPage(result, userObject) {
        //   var newURL = result + userObject;
        //   window.open(newURL,"_top"); 
        // }
        // document.querySelectorAll('nav li a').forEach(v=> {
        //   v.addEventListener('click', function() {
        //     const newURL = v.getAttribute('data-href');
        //     dom_dialog_Loading.show()
        //     if (window.scriptURL) {
        //       loadNewPage(window.scriptURL, newURL)
        //       return 
        //     }
        //     google.script.run.withSuccessHandler(loadNewPage).withUserObject(newURL).getScriptURL();
        //   })
        // })

        //初始化
        const table_tr = document.querySelector('#table_tr').cloneNode(true)
        const table_tr2 = document.querySelectorAll('#table_tr')[1].cloneNode(true)
        const dom_news = document.querySelector('#dialog_news')
        const dom_dialog_news = new bootstrap.Modal(dom_news, {
          keyboard: false
        })
        const dom_news2 = document.querySelector('#dialog_news2')
        const dom_dialog_news2 = new bootstrap.Modal(dom_news2, {
          keyboard: false
        })
        const dom_news_card = dom_news.querySelector('.card').cloneNode(true)
        dom_news.querySelector('.card').remove()

        const dom_news_card2 = dom_news2.querySelector('.card').cloneNode(true)
        dom_news2.querySelector('.card').remove()

        //系統訊息彈窗
        const dom_dialog_alert = new bootstrap.Modal('#dialog_alert', {
          keyboard: false
        })

        //綁定收盤價旁邊的問號
        // document.querySelector('#show_text_end_price').addEventListener('click', () => {
        //   document.querySelector('#dialog_alert .modal-body').textContent = "每日收盤都比前一天高的連續天數"
        //   dom_dialog_alert.show()
        // })
        //綁定新聞旁邊的問號
        document.querySelector('#show_text_news').addEventListener('click', () => {
          document.querySelector('#dialog_alert .modal-body').textContent = "這裡顯示的是24小時內的新聞數量"
          dom_dialog_alert.show()
        })

        //計算損益
        const calculate_cost = (a, b, c) => {
          a=String(a).replaceAll(',', '')
          b=String(b).replaceAll(',', '')
          c=String(c).replaceAll(',', '')
          //計算成本
          const a1 = Number(a)*Number(b)
          const a2 = Number((a1 * 0.1425 / 100 > 1 ? a1 * 0.1425 / 100 : 1).toFixed(0))
          const a3 = a1 + a2

          //計算現值
          const b1 = Number(a)*Number(c)
          const b2 = Number((b1 * 0.1425 / 100 > 1 ? b1 * 0.1425 / 100 : 1).toFixed(0)) + Number((b1 * 0.3 / 100).toFixed(0))
          const b3 = b1 - b2

          const c1 = b3 - a3
          const c2 = ((b3/a3*100).toFixed(2)-100).toFixed(2)
          return {c1, c2}
        }

        //取得日期
        const get_date = () => {
          const date = new Date()
          const year = date.getFullYear()
          const month = date.getMonth() + 1
          const day = date.getDate()
          return `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`
        }

        //顯示圖表
        const dialog_chartjs = document.querySelector('#dialog_chartjs')
        const dom_dialog_chartjs = new bootstrap.Modal(dialog_chartjs, {
          keyboard: false
        })
        const show_chartjs = async (stock) => {
          dom_dialog_chartjs.show()
          dialog_chartjs.querySelector('.modal-body').innerHTML = `
            <div class="spinner-border spinner-border-sm" role="status">
              <span class="visually-hidden"></span>
            </div>
            Loading...
          `

          const buy_stock = stock[0]
          const new_promise = () => {
            return new Promise(async (resolve, reject) => {
              resolve(await getDatas5_buy_history(buy_stock))
            })
          }
          const result = await new_promise()
          // console.log(result)

          //翻轉數據
          result.data.reverse()

          //計算每日的損益%數
          const cost = []
          for (let i=0; i<result.data.length; i++) {
            const {c1, c2} = calculate_cost(stock[6], stock[7], result.data[i].data)
            cost.push({
              label: result.data[i].label,
              data: result.data[i].label >= stock[5] ? c2 : 0
            })
          }

          //繪圖
          dialog_chartjs.querySelector('.modal-body').innerHTML = `<canvas id="myChart" class="w-100" height="400"></canvas>`
          const ctx = document.getElementById('myChart').getContext('2d');

          const labels = result.data.map(v=>v.label)
          //繪製result和cost(Y的單位不同, 所以要把cost的Y軸放在右邊)
          const myChart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: labels,
              datasets: [
                {
                  label: '收盤價',
                  data: result.data.map(v=>v.data),
                  borderColor: 'rgba(255, 99, 132, 1)',
                  borderWidth: 1,
                  fill: false,
                  yAxisID: 'y-axis-0'
                },
                {
                  label: '損益%',
                  data: cost.map(v=>v.data),
                  borderColor: 'rgba(54, 162, 235, 1)',
                  borderWidth: 1,
                  fill: false,
                  yAxisID: 'y-axis-1'
                }
              ]
            },
            options: {
              scales: {
                //labels的資料如果是stock[5]的話, 就標示不同顏色
                x: {
                  ticks: {
                    callback: function(value, index, values) {
                      if (labels[value] == stock[5]) {
                        return `*${labels[value]}*`
                      } else {
                        return labels[value]
                      }
                    }
                  }
                },
                'y-axis-0': {
                  type: 'linear',
                  position: 'left',
                },
                'y-axis-1': {
                  type: 'linear',
                  position: 'right',
                  ticks: {
                    callback: function(value, index, values) {
                      return value.toFixed(2) + '%';
                    }
                  }
                },
                
              },
              responsive: true,
              plugins: {
                zoom: {
                  pan: {
                    enabled: true,
                    mode: 'x',
                    speed: 10,
                    threshold: 10
                  },
                  zoom: {
                    wheel: {
                      enabled: true,
                    },
                    drag: {
                      enabled: true
                    },
                    pinch: {
                      enabled: true
                    },
                    mode: 'x',
                    speed: 0.1
                  }
                }
              }
            
            }
          });

        }

        //讀取資料
        const get_datas = async ()=>{
          const search_date = document.querySelector('#search_date').value
          // const search_date = ''
          const show_data = (data) => {

            if (data.error_msg) {
              document.querySelector('#dialog_alert .modal-body').textContent = data.error_msg
              dom_dialog_alert.show()
              return
            }
            
            document.querySelectorAll('#table_tr').forEach(v => v.remove())

            document.querySelector('#search_date').value = data.search_date
            // const setting_price1 = document.querySelector('#price1').checked
            // const setting_price2 = document.querySelector('#price2').checked
            // const setting_price3 = document.querySelector('#price3').checked

            //漲平跌家數統計
            // document.querySelector('#price1_badge').textContent = data.news.filter(v => /\+/.test(v[9])).length
            // document.querySelector('#price2_badge').textContent = data.news.filter(v => !/[\+\-]/.test(v[9])).length
            // document.querySelector('#price3_badge').textContent = data.news.filter(v => /\-/.test(v[9])).length

            //類別
            const category = new Set()

            const ai_news = []
            let kk = 0
            for (const k in data.news) {
              // if (k==0) continue
              const v = {
                stock: data.news[k]
              }
              v.news = data.news_1.filter(v2=> (new RegExp(v.stock[1])).test(v2[5]))
              v.news_ai = data.news_2.filter(v2=> (new RegExp(v.stock[1])).test(v2[2].split("\n")[0]))
              category.add(v.stock[2])
              
              const dom = table_tr.cloneNode(true)
              const dom2 = table_tr2.cloneNode(true)
              // dom.querySelector('.card-title').textContent = v[1]
              dom.setAttribute('data-category', v.stock[2])
              dom2.setAttribute('data-category', v.stock[2])
              const td = dom.querySelectorAll('td')
              // td[0].innerHTML = `${v.stock[1]}<br>${v.stock[0]}`
              td[0].innerHTML = `${v.stock[1]}<span class="d-1000-none"><br></span><span class="d-1000-inline"> (</span>${v.stock[0]}<span class="d-1000-inline"> )</span>
              <a href="https://www.fugle.tw/ai/${v.stock[0]}" class="text-decoration-none" id="show_chartjs" target="_blank"><i class="fa-solid fa-chart-line"></i></a>
              <a href="https://www.google.com/search?q=${encodeURIComponent(v.stock[1])}&tbm=nws&tbs=sbd:1" class="text-decoration-none" target="_blank">G</a>
              `
              //轉為億，小數點後兩位，四捨五入
              // td[3].textContent = `${(v.stock[4].replace(/,/g, '')/100000000).toFixed(2)}億`
              td[3].textContent = `-`
              if (v.stock[7]) {
                const {c1, c2} = calculate_cost(v.stock[6], v.stock[7], v.stock[8])
                td[1].textContent = `${v.stock[6].toLocaleString()}`
                td[2].textContent = `${v.stock[7].toLocaleString()}`
                td[3].innerHTML = `<span class="${c1 > 0? 'text-danger': (c1 < 0 ? 'text-success':'')}">${(c1).toLocaleString()}</span>`
                td[3].innerHTML = td[3].innerHTML + `
                  <span class="d-1000-none"><br></span>
                  <div class="d-none" id="continuous_up_data">${JSON.stringify(v.stock)}</div>
                  <span class="badge rounded-pill text-bg-info d-1000-none ${c1 > 0? 'text-danger': (c1 < 0 ? 'text-success':'')}">${c2}%</span>
                  <span class="badge rounded-pill text-bg-info d-1000-none">${v.stock[6].toLocaleString()}股</span>
                  <span class="badge rounded-pill text-bg-info d-1000-none">買均:${v.stock[7].toLocaleString()}</span>
                `
                td[4].textContent = `${c2}%`
                if (c2 != 0) {
                  td[4].classList.add(c2 > 0? 'text-danger': 'text-success')
                }
                dom2.querySelector('td').innerHTML = `${v.stock[5]}: ${v.stock[4]||'無備註'}`
              }

              td[5].querySelector('span').textContent = `${v.stock[8].replace(/,/g, '')}`
              // td[5].querySelector('span').textContent = `-`

              // td[5].querySelectorAll('span')[2].textContent = `${v.stock[16]}%`
              //漲跌標示
              if (/\+/.test(v.stock[9])) {
                td[5].querySelector('span').classList.add('text-danger')
              //   if (!setting_price1) {
              //     continue
              //   }
              // } else if (/\-/.test(v.stock[9])) {
              //   td[5].querySelector('span').classList.add('text-success')
              //   if (!setting_price3) {
              //     continue
              //   }
              // } else {
              //   if (!setting_price2) {
              //     continue
              //   }
              }
              if (v.stock[17] > 0) {
                td[5].querySelector('#continuous_up').classList.remove('d-none')
                td[5].querySelector('#continuous_up').textContent = v.stock[17] - 0 + 1
              }

              const turnover_data_stock = data.turnover_data_stock.find(v2=>v2.name == v.stock[1])
              //首次上榜
              if (!turnover_data_stock) {
                // dom.classList.add('bg-warning', 'bg-opacity-50')
              }
              if (turnover_data_stock) {
                const increase = ((Number(v.stock[8].replace(/,/g, '')) - turnover_data_stock.lowest_close_price)/turnover_data_stock.lowest_close_price*100).toFixed(2)
                td[3].innerHTML = td[3].innerHTML + `<br>
                  <span class="badge rounded-pill text-bg-info">入榜${turnover_data_stock.timer}次</span>
                  <span class="badge rounded-pill text-bg-info">累漲${increase}%</span>
                `
              }
              
              //顯示排名&是否熱門
              const is_fire = v.news.filter(v2 => v2[1] >= data.now).findIndex(v=> /熱門/.test(v[3])) >= 0 ? true : false
              const is_fire_week = v.news.filter(v2 => v2[1] >= data.now_week).findIndex(v=> /熱門族群/.test(v[3])) >= 0 ? true : false
              // dom.querySelector('th').innerHTML = `${++kk}${is_fire ? `<br><a href="javascript:void(0)" class="text-decoration-none" id="fire">🔥</a>` : ''}`
              dom.querySelector('th').innerHTML = `${is_fire ? `<br><a href="javascript:void(0)" class="text-decoration-none" id="fire">🔥</a>` : ''}`
              dom.querySelector('th').innerHTML += `${is_fire_week ? `<br><a href="javascript:void(0)" class="text-decoration-none" id="fire_week">&#129512;</a>` : ''}`
              if (dom.querySelector('th #fire')) {
                dom.querySelector('th #fire').addEventListener('click', () => {
                    //取得熱門新聞
                    const news = v.news.filter(v2 => v2[1] >= data.now && /熱門/.test(v2[3]))
                    dom_news.querySelector('.modal-title').textContent = `${v.stock[1]}(${v.stock[0]})`
                    dom_news.querySelector('.modal-body').innerHTML = ''
                    for (const v2 of news) {
                      const dom_news_card_clone = dom_news_card.cloneNode(true)
                      dom_news_card_clone.querySelector('.card-title').textContent = v2[3]
                      dom_news_card_clone.querySelector('#news_time').textContent = v2[1]
                      //渲染內容
                      const reg = new RegExp(`(${v.stock[0]}|${v.stock[1]})`, 'g')
                      dom_news_card_clone.querySelector('.card-text').innerHTML = v2[5].replace(reg, `<span class="bg-warning">$1</span>`)

                      dom_news_card_clone.querySelector('.card-link').href = v2[2]
                      dom_news_card_clone.querySelector('.card-link').textContent = v2[6]
                      dom_news.querySelector('.modal-body').append(dom_news_card_clone)
                    }
                    dom_dialog_news.show()
                })
              }
              if (dom.querySelector('th #fire_week')) {
                dom.querySelector('th #fire_week').addEventListener('click', () => {
                    //取得熱門新聞
                    const news = v.news.filter(v2 => v2[1] >= data.now_week && /熱門族群/.test(v2[3]))
                    dom_news.querySelector('.modal-title').textContent = `${v.stock[1]}(${v.stock[0]})`
                    dom_news.querySelector('.modal-body').innerHTML = ''
                    for (const v2 of news) {
                      const dom_news_card_clone = dom_news_card.cloneNode(true)
                      dom_news_card_clone.querySelector('.card-title').textContent = v2[3]
                      dom_news_card_clone.querySelector('#news_time').textContent = v2[1]
                      //渲染內容
                      const reg = new RegExp(`(${v.stock[0]}|${v.stock[1]})`, 'g')
                      dom_news_card_clone.querySelector('.card-text').innerHTML = v2[5].replace(reg, `<span class="bg-warning">$1</span>`)

                      dom_news_card_clone.querySelector('.card-link').href = v2[2]
                      dom_news_card_clone.querySelector('.card-link').textContent = v2[6]
                      dom_news.querySelector('.modal-body').append(dom_news_card_clone)
                    }
                    dom_dialog_news.show()
                })
              }
              // if (dom.querySelector('#show_chartjs')) {
              //   dom.querySelector('#show_chartjs').addEventListener('click', async () => {
              //     await show_chartjs(v.stock)
              //   })
              // }

              //亮燈標示
              const end_price = Number(v.stock[8].replace(/,/g, ''))
              const use_sub = /\+/.test(v.stock[9])?'-':''
              const light = Math.round(end_price/(end_price+Number(`${use_sub}${Number(v.stock[10])}`))*100)
              if (light == 110) {
                td[5].querySelector('span').classList.add('bg-danger', 'text-dark','p-1', 'rounded')
              } else if (light == 90) {
                td[5].querySelector('span').classList.add('bg-success', 'text-white','p-1', 'rounded')
              }
              
              //新聞按鈕
              td[6].querySelector('#b_news span').textContent = `${v.news.filter(v2 => v2[1] >= data.now).length}/${v.news.length}`
              td[6].querySelector('#b_news').addEventListener('click', function() {
                dom_news.querySelector('.modal-title').innerHTML = `${v.stock[1]}(${v.stock[0]})
                <a href="https://www.fugle.tw/ai/${v.stock[0]}" class="text-decoration-none" id="show_chartjs" target="_blank"><i class="fa-solid fa-chart-line"></i></a>
                <a href="https://www.google.com/search?q=${encodeURIComponent(v.stock[1])}&tbm=nws&tbs=sbd:1" class="text-decoration-none" target="_blank">G</a>
                `
                dom_news.querySelector('.modal-body').innerHTML = ''
                for (const v2 of v.news) {
                    const dom_news_card_clone = dom_news_card.cloneNode(true)
                    dom_news_card_clone.querySelector('.card-title').textContent = v2[3]
                    dom_news_card_clone.querySelector('#news_time').textContent = v2[1]
                    //渲染內容
                    const reg = new RegExp(`(${v.stock[0]}|${v.stock[1]})`, 'g')
                    dom_news_card_clone.querySelector('.card-text').innerHTML = v2[5].replace(reg, `<span class="bg-warning">$1</span>`)

                    dom_news_card_clone.querySelector('.card-link').href = v2[2]
                    dom_news_card_clone.querySelector('.card-link').textContent = v2[6]
                    dom_news.querySelector('.modal-body').append(dom_news_card_clone)
                }
                dom_dialog_news.show()
              })

              //分析按鈕
              td[6].querySelector('#b_news_ai span').textContent = `${v.news_ai.filter(v2 => {
                if (v2[0] >= data.now) {
                  const text = v2[2].split("\n")
                  ai_news.push(text.slice(0, text.length - 1).join("\n"))
                  return true
                }
                return false
              }).length}/${v.news_ai.length}`
              
              td[6].querySelector('#b_news_ai').addEventListener('click', function() {
                dom_news2.querySelector('.modal-title').textContent = `${v.stock[1]}(${v.stock[0]})`
                dom_news2.querySelector('.modal-body').innerHTML = ''
                for (const v2 of v.news_ai) {
                    const dom_news_card_clone = dom_news_card2.cloneNode(true)
                    dom_news_card_clone.querySelector('.card-title').remove()
                    dom_news_card_clone.querySelector('.card-subtitle #news_time').textContent = `${v2[0]}`

                    //渲染內容
                    const reg = new RegExp(`(${v.stock[0]}|${v.stock[1]})`, 'g')
                    const text = v2[2].split("\n")
                    // dom_news_card_clone.querySelector('.card-title').textContent = text[0]
                    const text2 = text.slice(1, text.length - 1).map(v3=> `<li>${v3.replace(/^[0-9]+\./, '')}</li>`)
                    dom_news_card_clone.querySelector('.card-text').innerHTML = `<ol class="m-0 ps-4">${text2.join("").replace(reg, `<span class="bg-warning">$1</span>`)}</ol>`

                    dom_news_card_clone.querySelector('.card-subtitle #news_link').innerHTML = `${text[text.length - 1].replace('新聞出處：','')}\n`.replace(/(https:\/\/.+)\n/g, `<a href="$1" target="_blank">${v2[1]}</a>\n`).replace(/\n/g, '<br>')
                    dom_news2.querySelector('.modal-body').append(dom_news_card_clone)
                }
                dom_dialog_news2.show()
              })
              
              document.querySelector('#table_tbody').append(dom)
              document.querySelector('#table_tbody').append(dom2)
            }
            // console.log(ai_news.join("\n\n"))

            //渲染類別
            document.querySelectorAll('#search_text option').forEach((v,k)=>{
              if (k>0) {
                v.remove()
              }
            })
            document.querySelectorAll('#buy_category option').forEach((v,k)=>{
              v.remove()
            })
            category.forEach(v=>{
              const dom = document.createElement('option')
              dom.value = v
              dom.textContent = v
              document.querySelector('#search_text').append(dom)

              const dom2 = document.createElement('option')
              dom2.value = v
              dom2.textContent = v
              document.querySelector('#buy_category').append(dom2)
            })

            //渲染股票代號
            document.querySelectorAll('#buy_stock option').forEach((v,k)=>{
              v.remove()
            })
            for (const v of stock_list) {
              const dom = document.createElement('option')
              dom.value = `${v[0]},${v[1]}`
              dom.textContent = `${v[0]} ${v[1]}`
              document.querySelector('#buy_stock').append(dom)
            }

            $('#buy_category').select2({
              // 启用标签功能，允许用户输入新的选项
              tags: true,
              // 允许清除选择
              allowClear: false,
              // 禁用多选功能，仅允许单选
              multiple: false,
              // 自定义提示文本
              placeholder: '請選擇或輸入...',
              // 自定义 "没有匹配项" 的提示文本
              // noResults: function() {
              //   return '未找到匹配项，请输入新的选项';
              // }
              // dropdownParent: $("#buy_category .modal-content")
              dropdownParent: $('#buyModal')
            });
            
            $('#buy_stock').select2({
              // 启用标签功能，允许用户输入新的选项
              tags: false,
              // 允许清除选择
              allowClear: false,
              // 禁用多选功能，仅允许单选
              multiple: false,
              // 自定义提示文本
              placeholder: '請選擇',
              // 自定义 "没有匹配项" 的提示文本
              // noResults: function() {
              //   return '未找到匹配项，请输入新的选项';
              // }
              // dropdownParent: $("#buy_category .modal-content")
              dropdownParent: $('#buyModal')
            });

            //更新收盤價
            update_end_price_f()

            document.querySelector('#buy_price_now').dispatchEvent(new Event('click'))
          }
          
          const new_promise = () => {
            return new Promise(async(resolve, reject) => {
              try {
                resolve(await getDatas5(search_date))
              } catch (error) {
                console.log(error)
                google.script.run.withSuccessHandler((data)=>{
                  resolve(data)
                }).getDatas5(search_date);
              }
            })
          }
          const result = await new_promise()
          show_data(result)
        }
        get_datas()

        //綁定查詢事件
        document.querySelector('#search').addEventListener('click', () => {
          document.querySelectorAll('#table_tr').forEach(v => v.remove())
          const dom = table_tr.cloneNode(true)
          document.querySelector('#table_tbody').append(dom)
          get_datas()
        })
        document.querySelector('#search_text').addEventListener('change', () => {
          const value = document.querySelector('#search_text').value
          document.querySelectorAll(`tbody tr`).forEach(v=>v.classList.remove('d-none'))
          if (!value) return
          document.querySelectorAll(`tbody tr`).forEach(v=>v.classList.add('d-none'))
          document.querySelectorAll(`tbody tr[data-category="${value}"]`).forEach(v=>v.classList.remove('d-none'))
        })

        //綁定下單事件
        let buyModal_loading = false
        const buyModal = new bootstrap.Modal('#buyModal', {})
        document.querySelector('#buy_submit').addEventListener('click', async (e) => {
          const form = document.querySelector('#buy_form')
          const check_form = form.checkValidity()
          event.preventDefault()
          event.stopPropagation()
          form.classList.add('was-validated')

          if (!check_form) {
            return
          }

          buyModal_loading = true

          const form_data = {}
          form_data.buy_category = document.querySelector('#buy_category').value
          form_data.buy_stock = document.querySelector('#buy_stock').value
          form_data.buy_in_out = document.querySelector('#buy_in').checked ? 'in' : 'out'
          form_data.buy_number = document.querySelector('#buy_number').value
          form_data.buy_price = document.querySelector('#buy_price').value
          form_data.buy_note = document.querySelector('#buy_note').value
          // console.log(form_data)
          
          //關閉buyModal
          buyModal.hide()

          const new_promise = () => {
            return new Promise(async (resolve, reject) => {
              resolve(await getDatas5_buy(form_data))
            })
          }
          const result = await new_promise()
          // console.log(result)

          dom_dialog_Loading.hide()
          document.querySelector('#dialog_alert .modal-body').textContent = '下單成功'

          //重整
          document.querySelectorAll('#table_tr').forEach(v => v.remove())
          const dom = table_tr.cloneNode(true)
          document.querySelector('#table_tbody').append(dom)
          get_datas()

          dom_dialog_alert.show()

        }, false)

        document.querySelector('#buyModal').addEventListener('hidden.bs.modal', event => {
          if (buyModal_loading) {
            buyModal_loading = false
            dom_dialog_Loading.show()
          }
        })

        //綁定即時股價按鈕
        let buy_price_now_run = false
        document.querySelector('#buy_price_now').addEventListener('click', async () => {
          if (buy_price_now_run) {
            return
          }
          buy_price_now_run = true
          
          const buy_stock = document.querySelector('#buy_stock').value.split(',')[0]
          document.querySelector('#buy_price_now').innerHTML = `
            <div class="spinner-border spinner-border-sm" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          `

          // const new_promise = () => {
          //   return new Promise((resolve, reject) => {
          //     google.script.run.withSuccessHandler((data)=>{
          //       resolve(data)
          //     }).getDatas5_buy_now(buy_stock);
          //   })
          // }
          // const result = await new_promise()
          // // console.log(result)
          // document.querySelector('#buy_price').value = result.price

          const result = await get_stock(buy_stock, buy_stock)
          document.querySelector('#buy_price').value = result.closePrice

          //觸發buy_price的keyup事件
          document.querySelector('#buy_price').dispatchEvent(new Event('keyup'))

          document.querySelector('#buy_price_now').innerHTML = `即時股價`
          buy_price_now_run = false

        })

        //綁定商品名稱改變事件(select2的change事件)
        $('#buy_stock').on('select2:select', function (e) {
          //觸發即時股價按鈕
          document.querySelector('#buy_price_now').dispatchEvent(new Event('click'))
          //觸發buy_price的keyup事件
          document.querySelector('#buy_price').dispatchEvent(new Event('keyup'))
        });

        //綁定#buy_number的keyup事件
        document.querySelector('#buy_number').addEventListener('keyup', () => {
          const buy_number = document.querySelector('#buy_number').value || 0
          const buy_price = document.querySelector('#buy_price').value || 0
          const buy_total = document.querySelector('#buy_total')
          buy_total.textContent = Number((buy_number * buy_price).toFixed(0)).toLocaleString() || '-'
        })

        //綁定#buy_price的keyup事件
        document.querySelector('#buy_price').addEventListener('keyup', () => {
          const buy_number = document.querySelector('#buy_number').value || 0
          const buy_price = document.querySelector('#buy_price').value || 0
          const buy_total = document.querySelector('#buy_total')
          buy_total.textContent = Number((buy_number * buy_price).toFixed(0)).toLocaleString() || '-'
        })

        //更新收盤價
        const update_end_price = async () => {
          let k = -1
          for (const v of document.querySelectorAll('#table_tbody tr')) {
            k++
            //v的class是d-none
            if (v.classList.contains('d-none')) {
              continue
            }
            if (!v.querySelector('#continuous_up_data')) {
              continue
            }
            const stock = JSON.parse(v.querySelector('#continuous_up_data').textContent)
            const result = await get_stock(k, stock[0])
            // console.log(result)
            const closePrice = result.closePrice
            const previousClose = result.previousClose
            if (closePrice && closePrice != stock[8]) {
              stock[8] = closePrice
              const td = v.querySelectorAll('td')
              const {c1, c2} = calculate_cost(stock[6], stock[7], closePrice)
              td[1].textContent = `${stock[6].toLocaleString()}`
              td[2].textContent = `${stock[7].toLocaleString()}`
              td[3].innerHTML = `<span class="${c1 > 0? 'text-danger': (c1 < 0 ? 'text-success':'')}">${(c1).toLocaleString()}</span>`
              td[3].innerHTML = td[3].innerHTML + `
                <a href="javascript:void(0);" class="text-decoration-none" id="show_chartjs"><i class="fa-solid fa-chart-line"></i></a>
                <span class="d-1000-none"><br></span>
                <div class="d-none" id="continuous_up_data">${JSON.stringify(stock)}</div>
                <span class="badge rounded-pill text-bg-info d-1000-none">${c2}%</span>
                <span class="badge rounded-pill text-bg-info d-1000-none">${stock[6].toLocaleString()}股</span>
                <span class="badge rounded-pill text-bg-info d-1000-none">買均:${stock[7].toLocaleString()}</span>
              `
              td[3].classList.remove('active')
              td[4].textContent = `${c2}%`
              if (c2 != 0) {
                td[4].classList.add(c2 > 0? 'text-danger': 'text-success')
              }
              td[4].classList.remove('active')
              td[5].querySelector('span').textContent = `${closePrice}`
              td[5].querySelector('span').classList.remove('text-danger', 'text-success', 'active')
              if (closePrice != previousClose) {
                td[5].querySelector('span').classList.add(closePrice > previousClose ? 'text-danger' : 'text-success')
              }
              setTimeout(() => {
                td[3].classList.add("active");
                td[4].classList.add("active");
                td[5].querySelector('span').classList.add("active");
              }, 100)

              
              v.querySelector('#show_chartjs').addEventListener('click', async () => {
                await show_chartjs(stock)
              })
            }
          }
        }

        //每10秒更新一次
        const update_end_price_f = () => {
          //現在日期和查詢的日期相同並且現在時間在9~16之間
          if (get_date() == document.querySelector('#search_date').value && new Date().getHours() >= 9 && new Date().getHours() <= 16) {
            update_end_price()
          }
        }
        setInterval(update_end_price_f, 10000)
      }

      const is_login = await checkLogin(); // 檢查登入狀態
      if (is_login) { 
        show_dom()
      }

    </script>
  </body>
</html>
